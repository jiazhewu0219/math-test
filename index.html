<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¤¾å€é•·è¼©èªçŸ¥è¨“ç·´ - æ•¸å­¸ç·´ç¿’ç”¢ç”Ÿå™¨</title>
    <!-- å¼•å…¥ Tailwind CSS ç”¨æ–¼å¿«é€Ÿæ’ç‰ˆ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* A4 è¦æ ¼å„ªåŒ– */
        @media print {
            .no-print { display: none !important; }
            body { background: white !important; margin: 0; padding: 0; }
            .page-break { 
                page-break-after: always; 
                margin: 0 !important;
                padding: 15mm !important;
                width: 210mm;
                height: 297mm;
                box-shadow: none !important;
            }
            @page {
                size: A4;
                margin: 0;
            }
        }
        body {
            font-family: "Microsoft JhengHei", "Heiti TC", sans-serif;
            -webkit-print-color-adjust: exact;
        }
        /* è¢å¹•é è¦½æ™‚çš„é é¢é™°å½± */
        .page-preview {
            width: 210mm;
            height: 297mm;
            padding: 15mm;
            margin: 20px auto;
            background: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            position: relative;
        }
    </style>
</head>
<body class="bg-slate-100">
    <div id="root"></div>

    <!-- è¼‰å…¥æ ¸å¿ƒ React èˆ‡ Babel -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script type="text/babel">
        const { useState } = React;

        const App = () => {
            const [difficulty, setDifficulty] = useState('20');
            const [type, setType] = useState('mix');
            const [pageCount, setPageCount] = useState(1);
            const [pages, setPages] = useState([]);

            const generateContent = () => {
                const newPages = [];
                const limit = parseInt(difficulty);

                for (let p = 1; p <= pageCount; p++) {
                    const questions = [];
                    for (let i = 1; i <= 24; i++) {
                        let n1, n2, op, ans;
                        
                        // æ±ºå®šé‹ç®—ç¬¦
                        if (type === 'add') op = '+';
                        else if (type === 'sub') op = '-';
                        else op = Math.random() > 0.5 ? '+' : '-';

                        if (op === '+') {
                            n1 = Math.floor(Math.random() * (limit - 1)) + 1;
                            n2 = Math.floor(Math.random() * (limit - n1)) + 1;
                            ans = n1 + n2;
                        } else {
                            n1 = Math.floor(Math.random() * (limit - 1)) + 2;
                            n2 = Math.floor(Math.random() * (n1 - 1)) + 1;
                            ans = n1 - n2;
                        }
                        questions.push({ id: i, n1, n2, op, ans });
                    }
                    newPages.push({ id: p, questions });
                }
                setPages(newPages);
            };

            return (
                <div className="min-h-screen pb-10">
                    {/* æ§åˆ¶é¢æ¿ */}
                    <div className="no-print sticky top-0 z-50 bg-white shadow-md p-6 mb-6 border-b-4 border-blue-500">
                        <div className="max-w-5xl mx-auto">
                            <h1 className="text-2xl font-bold text-slate-800 mb-4 flex items-center gap-2">
                                ğŸ“Š ç¤¾å€é•·è¼©æ•¸å­¸ç·´ç¿’ç”¢ç”Ÿå™¨
                            </h1>
                            <div className="grid grid-cols-1 md:grid-cols-4 gap-4 items-end">
                                <div>
                                    <label className="block text-sm font-bold text-slate-600 mb-1">é›£åº¦è¨­å®š</label>
                                    <select value={difficulty} onChange={(e) => setDifficulty(e.target.value)} className="w-full p-2 border rounded border-slate-300">
                                        <option value="10">åˆç´š (10ä»¥å…§)</option>
                                        <option value="20">ä¸­ç´š (20ä»¥å…§)</option>
                                        <option value="100">é€²éš (100ä»¥å…§)</option>
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-sm font-bold text-slate-600 mb-1">é‹ç®—é¡å‹</label>
                                    <select value={type} onChange={(e) => setType(e.target.value)} className="w-full p-2 border rounded border-slate-300">
                                        <option value="add">ç´”åŠ æ³•</option>
                                        <option value="sub">ç´”æ¸›æ³•</option>
                                        <option value="mix">åŠ æ¸›æ··åˆ</option>
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-sm font-bold text-slate-600 mb-1">å¼µæ•¸ (A4)</label>
                                    <input type="number" min="1" max="10" value={pageCount} onChange={(e) => setPageCount(parseInt(e.target.value))} className="w-full p-2 border rounded border-slate-300" />
                                </div>
                                <div className="flex gap-2">
                                    <button onClick={generateContent} className="flex-1 bg-blue-600 text-white font-bold py-2 rounded hover:bg-blue-700 transition">ç”Ÿæˆå…§å®¹</button>
                                    <button onClick={() => window.print()} className="flex-1 bg-green-600 text-white font-bold py-2 rounded hover:bg-green-700 transition">åˆ—å° / ä¸‹è¼‰</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* é é¢å…§å®¹æ¸²æŸ“ */}
                    <div className="flex flex-col items-center">
                        {pages.length === 0 && (
                            <div className="mt-20 text-slate-400 text-center no-print">
                                <p className="text-xl">è«‹è¨­å®šåƒæ•¸å¾Œé»æ“Šã€Œç”Ÿæˆå…§å®¹ã€</p>
                            </div>
                        )}

                        {/* ç·´ç¿’é¡Œé é¢ */}
                        {pages.map(page => (
                            <div key={`p-${page.id}`} className="page-preview page-break">
                                <div className="flex justify-between items-end border-b-2 border-slate-800 pb-2 mb-8">
                                    <div>
                                        <h2 className="text-2xl font-bold">èªçŸ¥å¥åº·ï¼šç®—è¡“ç·´ç¿’é¡Œ</h2>
                                        <p className="text-sm text-slate-500">é›£åº¦ï¼š{difficulty}ä»¥å…§ | é ç¢¼ï¼š{page.id}</p>
                                    </div>
                                    <div className="text-right">
                                        <p className="text-lg">å§“åï¼š______________</p>
                                        <p className="text-sm mt-1">æ—¥æœŸï¼š2025 å¹´ ___ æœˆ ___ æ—¥</p>
                                    </div>
                                </div>

                                <div className="grid grid-cols-2 gap-x-12 gap-y-6">
                                    {page.questions.map(q => (
                                        <div key={q.id} className="flex items-center justify-between border-b border-slate-200 pb-1">
                                            <span className="text-2xl font-mono text-slate-400 w-8">{q.id}.</span>
                                            <span className="text-3xl font-bold flex-1 text-center">
                                                {q.n1} {q.op} {q.n2} =
                                            </span>
                                            <div className="w-16 h-10 border-2 border-slate-400 rounded"></div>
                                        </div>
                                    ))}
                                </div>
                                <div className="absolute bottom-10 left-0 right-0 text-center text-slate-400 text-xs">
                                    æ­¤ç·´ç¿’ç”±ç¤¾å€é•·è¼©èªçŸ¥è¨“ç·´ç”¢ç”Ÿå™¨ç”Ÿæˆ
                                </div>
                            </div>
                        ))}

                        {/* ç­”æ¡ˆæª¢æ ¸é  */}
                        {pages.length > 0 && (
                            <div className="page-preview page-break bg-slate-50 border-2 border-dashed border-slate-300">
                                <h2 className="text-2xl font-bold text-center mb-6 border-b-2 border-slate-300 pb-2">ç­”æ¡ˆæª¢æ ¸é  (å‹¾é¸èˆ‡å°å¸³å°ˆç”¨)</h2>
                                <div className="grid grid-cols-2 gap-4">
                                    {pages.map(page => (
                                        <div key={`ans-p-${page.id}`} className="bg-white p-3 rounded shadow-sm">
                                            <h3 className="font-bold text-blue-700 border-b mb-2">ç¬¬ {page.id} é ç­”æ¡ˆ</h3>
                                            <div className="grid grid-cols-3 gap-x-2 gap-y-1 text-sm">
                                                {page.questions.map(q => (
                                                    <div key={q.id} className="flex gap-1">
                                                        <span className="text-slate-400">{q.id}.</span>
                                                        <span className="font-bold">{q.ans}</span>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
